<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å®‰å¤ªæ­²ç™»è¨˜è¡¨</title>
  <script src="https://unpkg.com/vue@3"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div id="app" class="container mt-4">
  <h3 class="mb-4">å®‰å¤ªæ­²ç™»è¨˜è¡¨</h3>
  <form @submit.prevent="submitForm">
    <div class="mb-3">
      <label class="form-label">å§“å</label>
      <input type="text" class="form-control" v-model="form.name" ref="nameRef" @keydown.enter.prevent="focusNext('birthRef')" required autofocus>
    </div>

    <div class="mb-3">
      <label class="form-label">ç”Ÿæ—¥</label>
      <input type="text" class="form-control" v-model="form.birth" placeholder="å¦‚ æ°‘åœ‹99å¹´01æœˆ02æ—¥ è«‹æ›¸å¯«> 99/01/02" ref="birthRef" @keydown.enter.prevent="focusNext('addressRef')">
    </div>

    <div class="mb-3">
      <label class="form-label">åœ°å€</label>
      <input type="text" class="form-control" v-model="form.address" ref="addressRef" @keydown.enter.prevent="focusNext('telRef')">
    </div>

    <div class="mb-3">
      <label class="form-label">é›»è©±</label>
      <input type="text" class="form-control" v-model="form.tel" ref="telRef" @keydown.enter.prevent="focusNext('emailRef')">
    </div>

    <div class="mb-3">
      <label class="form-label">éƒµä»¶ä¿¡ç®±</label>
      <input type="email" class="form-control" v-model="form.email" ref="emailRef" @keydown.enter.prevent="submitForm">
    </div>

    <div class="d-flex gap-2">
      <button type="submit" class="btn btn-primary">éƒµä»¶é€å‡º>ç™»è¨˜</button>
      <button type="button" class="btn btn-secondary" @click="printForm">åˆ—å°</button>
    </div>
	<td colspan="2" align="center" height="20">
	<hr>
	<font face="Tahoma" style="font-size: 11pt">
	<p style="margin-top: 0; margin-bottom: 0" align="left">
	<b>
	<font color="#990000" face="Tahoma" style="font-size: 11pt">
	å‚™è¨»ï¼šéƒµæ”¿åŠƒæ’¥å¸³è™Ÿï¼š</font>31584285<font color="#990000" face="Tahoma" style="font-size: 11pt">
	| æˆ¶åï¼š</font>æ¢…å±±ç‰è™›å®®</b></p>
	<p style="margin-top: 0; margin-bottom: 0" align="left">
	<b><font color="#990000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	æœ¬å®®æ”¶åˆ°å–„æ¬¾å¾Œï¼Œå°‡å¯„ä¸Šæ„Ÿè¬ç‹€ã€‚</font></b></p>
	</font>
	<p style="margin-top: 0; margin-bottom: 0" align="left">
	<font face="Tahoma" style="font-size: 11pt">
	<b><font color="#990000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	æ¯åé‡‘é¡é…Œæ”¶æ–°å°å¹£ </font>åä½°ä¼å…ƒæ­£<font color="#0000FF">
	</font><font color="#990000">ã€‚</font></b></font></p> 
</form>
</div>

<script>
const { createApp, ref } = Vue;

createApp({
  setup() {
    const form = ref({
      name: '',
      birth: '',
      address: '',
      tel: '',
      email: ''
    });

    const nameRef = ref(null);
    const birthRef = ref(null);
    const addressRef = ref(null);
    const telRef = ref(null);
    const emailRef = ref(null);

    const refs = {
      nameRef,
      birthRef,
      addressRef,
      telRef,
      emailRef
    };

    const focusNext = (nextField) => {
      refs[nextField]?.value?.focus();
    };

    const submitForm = () => {
      if (!form.value.email.includes('@')) {
        alert('è«‹è¼¸å…¥æ­£ç¢ºçš„ Email æ ¼å¼');
        return;
      }

      const subject = encodeURIComponent('å®‰å¤ªæ­²ç™»è¨˜è³‡æ–™');
      const body = encodeURIComponent(
        `ğŸ‘¤ å§“åï¼š${form.value.name}\n` +
        `ğŸ‚ ç”Ÿæ—¥ï¼š${form.value.birth}\n` +
        `ğŸ  åœ°å€ï¼š${form.value.address}\n` +
        `ğŸ“ é›»è©±ï¼š${form.value.tel}\n` +
        `ğŸ“§ éƒµç®±ï¼š${form.value.email}\n\n` +
        `æ•¬è«‹æŸ¥æ”¶ ğŸ™`
      );

      const recipient = 'msyusyu@yahoo.com.tw'; // è«‹æ”¹ç‚ºä½ è‡ªå·±çš„æ”¶ä»¶ä¿¡ç®±
      const mailtoLink = `mailto:${recipient}?subject=${subject}&body=${body}`;
      window.location.href = mailtoLink;

      alert('å·²é–‹å•Ÿé è¨­ä¿¡ç®± âœ‰ï¸ï¼Œè«‹ç¢ºèªå¯„ä»¶');
      form.value = { name: '', birth: '', address: '', tel: '', email: '' };
      nameRef.value.focus();
    };

    const printForm = () => {
      window.print();
    };

    return {
      form,
      nameRef, birthRef, addressRef, telRef, emailRef,
      focusNext,
      submitForm,
      printForm
    };
  }
}).mount('#app');
</script>
</body>
</html>